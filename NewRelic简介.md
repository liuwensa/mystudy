# 开发工具性能监控的好工具 - NewRelic 简介

## 部署工作

1. 创建一个NewRelic帐号
2. 安装newrelic包`npm install newrelic`
3. 把node_modules/newrelic/newrelic.js拷贝到项目根目录，然后修改其中的几个值
4. 在项目的启动根目录增加代码：`require('newrelic');`

将应用部署以后，等几分钟去访问NewRelic网站，就可以看到各种图表了。

## 数据分析

1. 事务的平均响应时间，用这个图可以对请求在服务器端耗时有个整体印象： 
![](http://i.imgur.com/ev5e7Pl.png)
从图表上可以看到，在这个时间段，请求的平均耗时是1450ms，同时可以看到每个请求的node代码和数据库执行时间占据了绝大部分，还有少量的外部服务调用时间。

2. 应用性能指数（Apdex score）蓝色表示优异（0.94分以上），绿色表示好，红色表示一般
![](http://i.imgur.com/IpTqoIh.png)

3. 系统吞吐率，rpm表示每分钟处理请求数。
![](http://i.imgur.com/dg3nGgI.png)
可以看出在这半个小时的区间，平均每分钟有40.5个请求。用这个图表，通过調整时间段（了解整个应用什么时候是高峰，什么时候是低谷，方便将一些批处理，备份等任务放在访问低谷的时间段进行。还有当用户报告无法访问的时候，可以通过查看吞吐量是否有急剧下降，来判断是个例还是整体故障，来确定解决问题的优先级。

4. 根据请求的时间和请求的次数，列出一个最耗时的请求url，优化这部分功能可以最有效的提高系统吞吐率
![](http://i.imgur.com/q4kKb7W.png)
我们可以根据这个排列顺序，来考虑对于访问量大，同时又耗时的请求进行重点性能优化。 点击具体的请求，还可以看到请求耗时的分布情况： 
![](http://i.imgur.com/vBPLvXf.png)
从图表上可以看到这个请求，在什么地方耗费了比较多的时间

5. 错误率 
![](http://i.imgur.com/4hEBaSF.png)

6. 应用性能分布到各个服务器状态
![](http://i.imgur.com/6EF97bK.png)
对于了解服务器资源和扩容计划很有帮助。

除了上述的这些性能图表，NewRelic也提供了很多监控的选项，比如ping，内存/存储警报等，可以将报警发送到邮件，或者推送到移动客户端：
![](http://i.imgur.com/L1m2xrS.png)